@page "/contactus"
@using EmployeeBlazorCRUD.Data
@using Microsoft.Extensions.Logging
@using Microsoft.AspNetCore.Components.Forms;
@inject ILogger<Contact> Logger
@inject ContactFormService _contactFormService;


@if (sent)
{
    <Alert Color="AlertColor.Success"> <Icon Name="IconName.CheckCircleFill" class="me-2"></Icon>Message sent !!!</Alert>
}
<Card Color="CardColor.Light" Class="mb-4" Style="width:100%;"> 
    <CardHeader>CONTACT US</CardHeader>
    <CardBody>
        <EditForm OnValidSubmit="Submit" Model="Model" FormName="Contact" >
            <DataAnnotationsValidator />
            <ValidationSummary />
            <div class="mb-4">
                <label class="d-flex gap-2 align-items-center">
                    <div Style="width:20%;">First Name:</div>
                    <InputText @bind-Value="Model!.FirstName" class="form-control py-3" />
                </label>
            </div>
            <div class="mb-4">
                <label class="d-flex gap-2 align-items-center">
                    <div Style="width:20%;">Last Name:</div>
                    <InputText @bind-Value="Model!.LastName" class="form-control py-3" />
                </label>
            </div>
            <div class="mb-4">
                <label class="d-flex gap-2 align-items-center">
                    <div Style="width:20%;">Phone:</div>
                    <InputText @bind-Value="Model!.Telephone" class="form-control py-3" />
                </label>
            </div>
            <div class="mb-4">
                <label class="d-flex gap-2 align-items-center">
                    <div Style="width:20%;">Email:</div>
                    <InputText @bind-Value="Model!.Email" class="form-control py-3" />
                </label>
            </div>
            <div class="mb-4">
                <label class="d-flex gap-2 align-items-center">
                    <div Style="width:20%;">Message:</div>
                    <InputTextArea @bind-Value="Model!.Message" class="form-control py-3" />
                </label>
            </div>
            <div class="d-flex justify-content-center">
                <button type="submit" class="btn btn-primary px-3" style="width:20%">Submit</button>
            </div>
        </EditForm>    
    </CardBody>
</Card>

@code {
    private bool sent = false;

    [SupplyParameterFromForm]
    private ContactUS? Model { get; set; }


    protected override void OnInitialized() =>
        Model ??= new() ;

    private async void Submit()
    {
        Logger.LogInformation("FirstName = {FirstName}", Model?.FirstName);
        if (await _contactFormService.AddContactForm(Model))
        {
            sent = true;
            Model = new();
        }
        else
        {
            sent = false;
        }

    }

}    

